# BTT Manta M4P v2.0 â€” Ender 3 V3 example Klipper config
# Assumptions: STM32G0B1 MCU, USB comms, 8KiB bootloader offset (0x08002000)

[mcu]
# Replace with your device ID from `/dev/serial/by-id/` on the host
serial: /dev/serial/by-id/usb-Klipper_stm32g0b1_REPLACE_ME

[printer]
kinematics: cartesian
max_velocity: 300
max_accel: 3000
max_z_velocity: 15
max_z_accel: 100
square_corner_velocity: 5.0

[stepper_x]
step_pin: MOTOR0_STEP
dir_pin: MOTOR0_DIR
enable_pin: !MOTOR0_EN
rotation_distance: 40
microsteps: 16
endstop_pin: ^X_STOP
position_endstop: 0
position_min: 0
position_max: 235

[tmc2209 stepper_x]
uart_pin: MOTOR0_UART
run_current: 0.80
hold_current: 0.50
stealthchop_threshold: 0

[stepper_y]
step_pin: MOTOR1_STEP
dir_pin: MOTOR1_DIR
enable_pin: !MOTOR1_EN
rotation_distance: 40
microsteps: 16
endstop_pin: ^Y_STOP
position_endstop: 0
position_min: 0
position_max: 235

[tmc2209 stepper_y]
uart_pin: MOTOR1_UART
run_current: 0.90
hold_current: 0.60
stealthchop_threshold: 0

[stepper_z]
step_pin: MOTOR2_STEP
dir_pin: MOTOR2_DIR
enable_pin: !MOTOR2_EN
rotation_distance: 8
microsteps: 16
endstop_pin: ^Z_STOP
position_endstop: 0
position_min: 0
position_max: 250

[tmc2209 stepper_z]
uart_pin: MOTOR2_UART
run_current: 0.90
hold_current: 0.60
stealthchop_threshold: 0

[extruder]
step_pin: MOTOR3_STEP
dir_pin: MOTOR3_DIR
enable_pin: !MOTOR3_EN
rotation_distance: 22.8
microsteps: 16
nozzle_diameter: 0.4
filament_diameter: 1.75
heater_pin: HOTEND_HEATER
sensor_type: EPCOS 100K B57560G104F
sensor_pin: HOTEND_THERMISTOR
min_temp: 0
max_temp: 300

[tmc2209 extruder]
uart_pin: MOTOR3_UART
run_current: 0.80
hold_current: 0.50
stealthchop_threshold: 0

[heater_bed]
heater_pin: BED_HEATER
sensor_type: Generic 3950
sensor_pin: BED_THERMISTOR
min_temp: 0
max_temp: 120

[fan]
pin: PART_COOLING

[heater_fan hotend_fan]
pin: HOTEND_FAN
heater: extruder
heater_temp: 50.0

[bltouch]
sensor_pin: PROBE_SIGNAL
control_pin: PROBE_SERVO
x_offset: -44
y_offset: -7
z_offset: 0

[safe_z_home]
home_xy_position: 117.5,117.5
speed: 80
z_hop: 10
z_hop_speed: 10

[input_shaper]
shaper_type_x: mzv
shaper_freq_x: 40
shaper_type_y: mzv
shaper_freq_y: 40

[bed_screws]
screw1: 30,30
screw2: 205,30
screw3: 205,205
screw4: 30,205